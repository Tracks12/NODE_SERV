<!DOCTYPE Html>
<!-- code.html -->
<html>
	<head>
		<meta charset="utf-8">
		<title>Node JS Server Test</title>
		<link rel="icon" type="image/png" href="./pics/icon.png" />
		<link rel="stylesheet" type="text/css" href="./css/style.css" />
		<script language="javascript" type="text/javascript" src="./js/script.js"></script>
	</head>
	<body onload="startTime(); check(); editor();">
		<header>
			<a href="/">
				<svg version="1.1" viewBox="0 0 128 128" xmlns="http://www.w3.org/2000/svg">
					<path class="st0" d="M64,14c-27.6,0-50,22.4-50,50s22.4,50,50,50s50-22.4,50-50S91.6,14,64,14z"/>
					<g>
						<path class="st1" d="M64,95.9c-0.9,0-1.7-0.2-2.5-0.7l-7.8-4.6c-1.2-0.7-0.6-0.9-0.2-1c1.6-0.6,1.9-0.7,3.5-1.6   c0.2-0.1,0.4-0.1,0.6,0.1l6,3.6c0.2,0.1,0.5,0.1,0.7,0l23.4-13.5c0.2-0.1,0.4-0.4,0.4-0.6v-27c0-0.3-0.1-0.5-0.4-0.6L64.4,36.4   c-0.2-0.1-0.5-0.1-0.7,0L40.3,49.8c-0.2,0.1-0.4,0.4-0.4,0.6v27c0,0.2,0.1,0.5,0.4,0.6l6.4,3.7c3.5,1.7,5.6-0.3,5.6-2.4V52.8   c0-0.4,0.3-0.7,0.7-0.7h3c0.4,0,0.7,0.3,0.7,0.7v26.6c0,4.7-2.5,7.3-6.9,7.3c-1.4,0-2.4,0-5.4-1.5l-6.1-3.5   c-1.5-0.9-2.5-2.5-2.5-4.3v-27c0-1.7,0.9-3.4,2.5-4.3l23.4-13.5c1.5-0.8,3.5-0.8,4.9,0l23.4,13.5c1.5,0.9,2.5,2.5,2.5,4.3v27   c0,1.7-0.9,3.4-2.5,4.3L66.5,95.3C65.7,95.7,64.9,95.9,64,95.9z"/>
						<path class="st1" d="M71.3,77.3c-10.2,0-12.4-4.7-12.4-8.6c0-0.4,0.3-0.7,0.7-0.7h3c0.3,0,0.6,0.2,0.7,0.6c0.4,3.1,1.8,4.6,8,4.6   c4.9,0,7-1.1,7-3.7c0-1.5-0.6-2.6-8.3-3.4c-6.4-0.6-10.4-2-10.4-7.2c0-4.7,4-7.5,10.7-7.5c7.5,0,11.2,2.6,11.7,8.2   c0,0.2-0.1,0.4-0.2,0.5c-0.1,0.1-0.3,0.2-0.5,0.2h-3c-0.3,0-0.6-0.2-0.7-0.5c-0.7-3.2-2.5-4.3-7.3-4.3c-5.4,0-6,1.9-6,3.3   c0,1.7,0.7,2.2,8,3.2c7.2,0.9,10.6,2.3,10.6,7.3C82.9,74.4,78.7,77.3,71.3,77.3z"/>
					</g>
				</svg>
			</a>
			<h1>Node JS Server Test - CODE SOURCE</h1>
			<div id="time"></div>
		</header>
		<nav>
			<ul>
				<li class="nav"><a href="./index.html">Accueil</a></li>
				<li class="nav"><a href="./tree.html">Plan du Site</a></li>
				<li class="nav"><a href="./code.html">Code Source</a></li>
				<li class="nav"><a href="./about.html">Plus</a></li>
			</ul>
		</nav>
		<section>
			<aside>
				<h2>Code Source Du Server.js</h2>
				<pre><ul><li>var conf = require('./conf.json'),</li>
<li>    http = require('http'),</li>
<li>    url = require('url'),</li>
<li>    fs = require('fs');</li>
<li></li>
<li>function onRequest(request, response) {</li>
<li>	var pathname = url.parse(request.url).pathname,</li>
<li>       info = { 'extension' : pathname.split('.').pop(), 'path' : pathname.split('/').pop() },</li>
<li>       error, code, today = new Date(),</li>
<li>       result = '['+today.getHours()+':'+today.getMinutes()+':'+today.getSeconds()+'] ';</li>
<li>  </li>
<li>	if(info['path'] == '') { pathname = pathname+conf.http.index; info['extension'] = 'html'; }</li>
<li>	</li>
<li>	try {</li>
<li>		response.writeHead(200, { 'Content-Type' : conf.http.mimes[info['extension']], 'Charset' : conf.http.charset });</li>
<li>		response.end(fs.readFileSync(conf.http.www+pathname));</li>
<li>		result += 'code 200 to : '.toLocaleUpperCase()+pathname;</li>
<li>	}</li>
<li>	catch(e) {</li>
<li>		switch(info['path']) {</li>
<li>			case '.htaccess': code = 403;</li>
<li>				error = '&#60;div&#62;&#60;h1&#62;Erreur '+code+'&#60;/h1&#62;&#60;h2&#62;Accès aux fichier refusé&#60;/h2&#62;&#60;br /&#62;&#60;p&#62;Le fichier "'+info['path']+'" n\'est pas accessible&#60;/p&#62;&#60;br /&#62;&#60;a href="/"&#62;Retour à l\'Index&#60;/a&#62;&#60;/div&#62;';</li>
<li>				break;</li>
<li>			default: code = 404;</li>
<li>				error = '&#60;div&#62;&#60;h1&#62;Erreur '+code+'&#60;/h1&#62;&#60;h2&#62;Fichier non trouvé&#60;/h2&#62;&#60;br /&#62;&#60;p&#62;Le chemin "'+pathname+'" n\'existe pas&#60;/p&#62;&#60;br /&#62;&#60;a href="/"&#62;Retour à l\'Index&#60;/a&#62;&#60;/div&#62;';</li>
<li>				break;</li>
<li>		}</li>
<li>		</li>
<li>		response.writeHead(code, { 'Content-Type' : conf.http.mimes['html'], "Charset" : conf.http.charset });</li>
<li>		response.end(fs.readFileSync(conf.http.error)+error);</li>
<li>		result += 'code '+code+' to : '.toLocaleUpperCase()+pathname+'\n'+e;</li>
<li>	} console.log(result);</li>
<li>}</li>
<li></li>
<li>switch(process.argv[2]) {</li>
<li>	case '-ls': var files = new Array(), i = new Array(0, 0);</li>
<li>		fs.readdirSync(conf.http.www).forEach(file => { files[i[1]] = file; i[1]++; });</li>
<li>		console.log(files);</li>
<li>		break;</li>
<li>	case '-start': http.createServer(onRequest).listen(conf.http.port);</li>
<li>		console.log('Node JS Server is starting...\n');</li>
<li>		break;</li>
<li>	case '-h':</li>
<li>	case '--help':</li>
<li>	default: var helper = 'server.js  -start\t: Démarre un serveur local sur le port '+conf.http.port+'\n';</li>
<li>		helper += '\t   -ls\t\t: Liste les fichiers présents dans le répertoire "'+conf.http.www+'"\n';</li>
<li>		helper += '\t   -h\t\t: Affiche les arguments de commandes\n\n';</li>
<li>		helper += '\t   --help\t: Affiche les arguments de commandes\n\n';</li>
<li>		console.log(helper);</li>
<li>		break;</li>
<li>}</li></ul></pre>
				<br />
			</aside>
			<br /><br />
			<aside>
				<h2>Code Source Du Conf.json</h2>
					<pre><ul><li>{</li>
<li>	"http" : {</li>
<li>		"www" : "./www/",</li>
<li>		"port" : 69,</li>
<li>		"index" : "index.html",</li>
<li>		"charset" : "utf-8",</li>
<li>		"error" : "ERROR.html",</li>
<li>		"mimes" : {</li>
<li>			"php" : "text/php",</li>
<li>			"html" : "text/html",</li>
<li>			"svg" : "text/html",</li>
<li>			"css" : "text/css",</li>
<li>			"js" : "application/javascript",</li>
<li>			"ttf" : "font/ttf",</li>
<li>			"ico" : "image/ico",</li>
<li>			"png" : "image/png",</li>
<li>			"jpg" : "image/jpg",</li>
<li>			"jpeg" : "image/jpeg",</li>
<li>			"gif" : "image/gif"</li>
<li>		}</li>
<li>	}</li>
<li>}</li></ul></pre>
				<br />
			</aside>
		</section>
		<footer>
			<p><a href="https://nodejs.org/fr/" target="_blank">Node JS</a> | Anarchy</p>
		</footer>
	</body>
</html>
<!-- END -->
